# Licensed to the Apache Software Foundation (ASF) under one or more
# contributor license agreements.  See the NOTICE file distributed with
# this work for additional information regarding copyright ownership.
# The ASF licenses this file to You under the Apache License, Version 2.0
# (the "License"); you may not use this file except in compliance with
# the License.  You may obtain a copy of the License at
#
#    http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.


#
# This file defines the Flink build for the "apache/flink" repository, including
# the following:
#  - PR builds (triggered through ci-bot)
#  - custom triggered e2e tests
#  - nightly builds

name: "Test OpenSSL on self-hosted"

on: [push]
jobs:
  compile_ci:
    runs-on: self-hosted
    steps:
      - run: openssl version
      - name: Install OpenSSL
        run: |
          echo "Installing required software"
          sudo apt-get update; apt-get upgrade -y ; \
          sudo apt-get install -y gosu sudo locales make less git build-essential openjdk-8-jdk curl libapr1 unzip uuid-runtime jq bsdmainutils wget python docker.io psmisc software-properties-common apt-transport-https
          sudo apt-get install -y bc libapr1
          # install libssl1.0.0 for netty tcnative
          wget http://security.ubuntu.com/ubuntu/pool/main/o/openssl1.0/libssl1.0.0_1.0.2n-1ubuntu5.7_amd64.deb
          sudo apt install ./libssl1.0.0_1.0.2n-1ubuntu5.7_amd64.deb
